<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Assas Calendar Exporter - Installation</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial,
          sans-serif;
        line-height: 1.6;
        color: #333;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        padding: 20px;
      }

      .container {
        max-width: 700px;
        margin: 0 auto;
        background: white;
        border-radius: 16px;
        padding: 40px;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      }

      header {
        text-align: center;
        margin-bottom: 40px;
      }

      h1 {
        font-size: 2.5em;
        margin-bottom: 10px;
        color: #2c3e50;
      }

      .subtitle {
        font-size: 1.2em;
        color: #7f8c8d;
      }

      .installation {
        margin-bottom: 40px;
      }

      .installation h2 {
        font-size: 1.8em;
        margin-bottom: 30px;
        color: #2c3e50;
        text-align: center;
      }

      .step {
        background: #f8f9fa;
        border-radius: 12px;
        padding: 30px;
        margin-bottom: 25px;
        border-left: 5px solid #667eea;
      }

      .step-number {
        display: inline-block;
        background: #667eea;
        color: white;
        width: 35px;
        height: 35px;
        border-radius: 50%;
        text-align: center;
        line-height: 35px;
        font-weight: bold;
        margin-right: 10px;
        font-size: 1.2em;
      }

      .step p {
        margin: 10px 0;
        font-size: 1.1em;
      }

      .step strong {
        color: #2c3e50;
      }

      .bookmarklet-button {
        display: inline-block;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 20px 40px;
        font-size: 1.3em;
        font-weight: bold;
        text-decoration: none;
        border-radius: 12px;
        box-shadow: 0 8px 20px rgba(102, 126, 234, 0.4);
        transition: all 0.3s ease;
        cursor: grab;
        margin: 20px 0;
        text-align: center;
        min-width: 280px;
      }

      .bookmarklet-button:hover {
        transform: translateY(-3px);
        box-shadow: 0 12px 30px rgba(102, 126, 234, 0.5);
      }

      .bookmarklet-button:active {
        cursor: grabbing;
        transform: translateY(-1px);
      }

      .button-container {
        text-align: center;
        margin: 25px 0;
      }

      .hint {
        text-align: center;
        font-size: 0.95em;
        color: #7f8c8d;
        margin-top: 10px;
      }

      .step ol {
        margin-left: 20px;
        margin-top: 15px;
      }

      .step li {
        margin: 8px 0;
        font-size: 1.05em;
      }

      .step a {
        color: #667eea;
        text-decoration: none;
        font-weight: 500;
      }

      .step a:hover {
        text-decoration: underline;
      }

      .step a.bookmarklet-button {
        color: white;
        text-decoration: none;
        font-weight: bold;
      }

      .step a.bookmarklet-button:hover {
        text-decoration: none;
      }

      .help {
        background: #fff3cd;
        border-left: 5px solid #ffc107;
        border-radius: 12px;
        padding: 25px;
        margin-bottom: 30px;
      }

      .help h3 {
        margin-bottom: 15px;
        color: #856404;
      }

      .help h4 {
        color: #856404;
      }

      .help ul {
        margin-left: 20px;
        margin-top: 10px;
      }

      .help li {
        margin: 8px 0;
      }

      textarea {
        width: 100%;
        height: 120px;
        margin: 15px 0;
        padding: 12px;
        border: 2px solid #ffc107;
        border-radius: 6px;
        font-family: monospace;
        font-size: 0.85em;
        resize: vertical;
      }

      .copy-button {
        background: #ffc107;
        color: #856404;
        border: none;
        padding: 12px 30px;
        font-size: 1em;
        font-weight: bold;
        border-radius: 6px;
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .copy-button:hover {
        background: #e0a800;
        transform: translateY(-2px);
      }

      .copy-button:active {
        transform: translateY(0);
      }

      footer {
        text-align: center;
        padding-top: 30px;
        border-top: 2px solid #e9ecef;
        color: #7f8c8d;
        font-size: 0.95em;
      }

      footer a {
        color: #667eea;
        text-decoration: none;
        font-weight: 500;
      }

      footer a:hover {
        text-decoration: underline;
      }

      @media (max-width: 600px) {
        .container {
          padding: 25px;
        }

        h1 {
          font-size: 2em;
        }

        .subtitle {
          font-size: 1em;
        }

        .installation h2 {
          font-size: 1.4em;
          margin-bottom: 20px;
        }

        .bookmarklet-button {
          font-size: 1.1em;
          padding: 18px 30px;
          min-width: 240px;
        }

        .step {
          padding: 20px;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <header>
        <h1>üìÖ Assas Calendar Exporter</h1>
      </header>

      <main>
        <section class="installation">
          <h2>üì• Installation (30 secondes)</h2>

          <!-- Desktop instructions -->
          <div class="step" id="desktop-instructions">
            <p>
              <span class="step-number">1</span><strong>Fais glisser ce bouton</strong> vers ta
              barre de favoris :
            </p>
            <div class="button-container">
              <a href="#" id="bookmarklet-link" class="bookmarklet-button">
                üìÖ Export Assas Calendar
              </a>
            </div>
            <p class="hint">üëÜ Clique et glisse vers le haut de ton navigateur</p>
          </div>

          <!-- Mobile instructions (hidden by default, shown on mobile) -->
          <div class="step" id="mobile-instructions" style="display: none">
            <p><span class="step-number">1</span><strong>Copie le code :</strong></p>
            <div class="button-container">
              <button
                onclick="copyCodeMobile()"
                class="bookmarklet-button"
                style="cursor: pointer; border: none"
              >
                üìã Copier le code
              </button>
            </div>
          </div>

          <div class="step" id="mobile-step-2" style="display: none">
            <p><span class="step-number">2</span><strong>Cr√©e un favori :</strong></p>
            <ol style="margin-top: 15px">
              <li>Ajoute cette page en favori (üì§ Partager ‚Üí Favoris)</li>
              <li>Modifie le favori ‚Üí Colle le code dans "URL"</li>
              <li>Renomme-le "üìÖ Export Assas"</li>
            </ol>
          </div>

          <div class="step" id="mobile-step-3" style="display: none">
            <p><span class="step-number">3</span><strong>Utilise-le sur Assas</strong></p>
            <ol style="margin-top: 15px">
              <li>
                Va sur
                <a href="https://celcat-web.u-paris2.fr/calendar/" target="_blank"
                  >ton calendrier</a
                >
              </li>
              <li>Clique sur ton favori "üìÖ Export Assas"</li>
              <li>T√©l√©charge ton .ics et importe-le dans ton calendrier</li>
            </ol>
          </div>

          <div class="step" id="desktop-step-2">
            <p><span class="step-number">2</span><strong>Utilise-le sur Assas</strong></p>
            <ol>
              <li>
                Va sur
                <a href="https://celcat-web.u-paris2.fr/calendar/" target="_blank"
                  >ton calendrier</a
                >
                et connecte-toi
              </li>
              <li>Clique sur ton favori "üìÖ Export Assas Calendar"</li>
              <li>Suis les instructions et t√©l√©charge ton fichier .ics</li>
              <li>Importe-le dans Google Calendar, Apple Calendar ou Outlook</li>
            </ol>
          </div>
        </section>

        <section class="help">
          <h3>‚ùì Le glisser-d√©poser ne marche pas ?</h3>
          <p>Pas de panique ! Voici des alternatives :</p>
          <ul>
            <li>
              <strong>M√©thode 1</strong> : Fais un clic droit sur le bouton ‚Üí "Ajouter aux favoris"
            </li>
            <li><strong>M√©thode 2</strong> : Copie le code manuellement ci-dessous</li>
          </ul>

          <h4 style="margin-top: 20px">üìã Copier le code manuellement</h4>

          <p style="margin-top: 10px">
            Copie ce code, puis cr√©e un nouveau favori et colle-le comme URL :
          </p>
          <textarea readonly id="bookmarklet-code">BOOKMARKLET_CODE_RAW</textarea>
          <button class="copy-button" onclick="copyCode()">üìã Copier le code</button>
        </section>
      </main>

      <footer>
        <p>
          Cr√©√© avec ‚ù§Ô∏è pour les √©tudiants d'Assas par
          <a
            href="https://github.com/tomspace900"
            target="_blank"
            style="color: #667eea; text-decoration: none; font-weight: 500"
            >Thomas Gendron</a
          >
        </p>
        <p style="margin-top: 10px">
          <a href="https://github.com/tomspace900/assas-cal-exporter" target="_blank"
            >Voir le code sur GitHub</a
          >
        </p>
      </footer>
    </div>

    <script>
      // Bookmarklet code injected at build time
      const BOOKMARKLET_CODE = "BOOKMARKLET_CODE_ESCAPED";

      // Detect if user is on mobile/tablet
      function isMobile() {
        return (
          /iPhone|iPad|iPod|Android/i.test(navigator.userAgent) ||
          (navigator.maxTouchPoints && navigator.maxTouchPoints > 2)
        );
      }

      // Inject bookmarklet href dynamically to avoid HTML escaping issues
      document.addEventListener("DOMContentLoaded", function () {
        const link = document.getElementById("bookmarklet-link");
        if (link) {
          link.href = BOOKMARKLET_CODE;
        }

        // Show mobile-specific instructions if on mobile
        if (isMobile()) {
          const desktopInstructions = document.getElementById("desktop-instructions");
          const mobileInstructions = document.getElementById("mobile-instructions");
          const mobileStep2 = document.getElementById("mobile-step-2");
          const mobileStep3 = document.getElementById("mobile-step-3");
          const desktopStep2 = document.getElementById("desktop-step-2");
          const helpSection = document.querySelector(".help");

          if (desktopInstructions) desktopInstructions.style.display = "none";
          if (mobileInstructions) mobileInstructions.style.display = "block";
          if (mobileStep2) mobileStep2.style.display = "block";
          if (mobileStep3) mobileStep3.style.display = "block";
          if (desktopStep2) desktopStep2.style.display = "none";
          if (helpSection) helpSection.style.display = "none";
        }
      });

      function copyCodeMobile() {
        const textarea = document.getElementById("bookmarklet-code");
        textarea.select();
        textarea.setSelectionRange(0, 99999);

        try {
          document.execCommand("copy");
          const button = event.target;
          const originalText = button.textContent;
          button.textContent = "‚úÖ Copi√© !";
          button.style.background = "#28a745";

          setTimeout(() => {
            button.textContent = originalText;
            button.style.background = "linear-gradient(135deg, #667eea 0%, #764ba2 100%)";
          }, 2000);
        } catch (err) {
          alert("Erreur lors de la copie. S√©lectionne le texte manuellement.");
        }
      }

      function copyCode() {
        const textarea = document.getElementById("bookmarklet-code");
        textarea.select();
        textarea.setSelectionRange(0, 99999); // Pour mobile

        try {
          document.execCommand("copy");
          const button = document.querySelector(".copy-button");
          const originalText = button.textContent;
          button.textContent = "‚úÖ Copi√© !";
          button.style.background = "#28a745";
          button.style.color = "white";

          setTimeout(() => {
            button.textContent = originalText;
            button.style.background = "#ffc107";
            button.style.color = "#856404";
          }, 2000);
        } catch (err) {
          alert(
            "Erreur lors de la copie. S√©lectionne le texte manuellement et copie-le avec Ctrl+C (ou Cmd+C sur Mac)."
          );
        }
      }
    </script>
  </body>
</html>
